Producer

在catch里面对发送消息的错误进行处理：并重发消息，手动重试和自动重试



broker

通过配置参数实现： 

单节点：配置刷盘策略，在消息写入磁盘以后再给producer发送ack

集群：将集群配置成：至少发送2个以上的节点，才返回ack

consumer

执行完所有业务以后才发送消息确认

如果业务比较耗时，先将消息存入数据库，然后再发送消费确认