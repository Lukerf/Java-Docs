### 1. 限流策略

#### 1.1 固定窗口计数器算法

​	概念：单位时间内处理请求的数量

​	缺点：无法处理突然激增的流量，比如1分钟内允许的请求数为100个，第1s内的请求为100个刚好等于整个窗口的最大值，那么后续2-59s都无法处理请求

#### 1.2 滑动窗口计数器算法

​	概念：将窗口划分为一个个的时间区间，当请求的时间大于当前窗口的最大时间时，把之前最小的区间丢弃，往后面滑动增加区间，区间划分约细，限流统计约平滑。解决了固定窗口实例中第2-59s都无法处理请求的问题。

#### 1.3 漏桶算法

​	概念：将请求放入到桶中（可以是消息队列），然后定期从桶中拿请求来执行，超过桶容量的请求就丢弃

#### 1.4 令牌桶算法

​	概念：按照稳定速率往桶中放入令牌，请求在被处理前需要从桶中获取令牌，获取不到则被丢弃

### 2. 限流方案

#### 1.1 单机限流

Google Guava自带限流类RateLimiter: 基于令牌桶算法

Bucket4j库：功能更加全面，基于令牌/漏桶算法

#### 1.2 分布式限流

中间件：Sentinel

网关层限流：Spring Cloud Gateway，基于Redis+Lua实现



