### 参数校验

##### 普通用法

1. 引入依赖，spring-boot-starter-web 依赖中已经有 hibernate-validator 包，不需要引用相关依赖

2. 对校验对象进行校验规则的制定 

   ```java
   @Data
   @AllArgsConstructor
   @NoArgsConstructor
   public class Person {
   
       @NotNull(message = "classId 不能为空")
       private String classId;
   
       @Size(max = 33)
       @NotNull(message = "name 不能为空")
       private String name;
   
       @Pattern(regexp = "((^Man$|^Woman$|^UGM$))", message = "sex 值不在可选范围")
       @NotNull(message = "sex 不能为空")
       private String sex;
   
       @Email(message = "email 格式不正确")
       @NotNull(message = "email 不能为空")
       private String email;
   
   }
   ```

   **常用字段验证注解包括**

   `@NotEmpty` 被注释的字符串的不能为 null 也不能为空

   `@NotBlank` 被注释的字符串非 null，并且必须包含一个非空白字符

   `@Null` 被注释的元素必须为 null

   `@NotNull` 被注释的元素必须不为 null

   `@AssertTrue` 被注释的元素必须为 true

   `@AssertFalse` 被注释的元素必须为 false

   `@Pattern(regex=,flag=)`被注释的元素必须符合指定的正则表达式

   `@Email` 被注释的元素必须是 Email 格式。

   `@Min(value)`被注释的元素必须是一个数字，其值必须大于等于指定的最小值

   `@Max(value)`被注释的元素必须是一个数字，其值必须小于等于指定的最大值

   `@DecimalMin(value)`被注释的元素必须是一个数字，其值必须大于等于指定的最小值

   `@DecimalMax(value)` 被注释的元素必须是一个数字，其值必须小于等于指定的最大值

   `@Size(max=, min=)`被注释的元素的大小必须在指定的范围内

   `@Digits(integer, fraction)`被注释的元素必须是一个数字，其值必须在可接受的范围内

   `@Past`被注释的元素必须是一个过去的日期

   `@Future` 被注释的元素必须是一个将来的日期

3. controller中使用

   ```java
   @RestController
   @RequestMapping("/api")
   @Validated // 不要忘记在类中加入这个注解，否则会抛出异常
   public class PersonController {
   
       @PostMapping("/person")
       public ResponseEntity<Person> getPerson(@RequestBody @Valid Person person) {
           return ResponseEntity.ok().body(person);
       }
   }
   ```

##### 进阶用法

**@Validated分组校验**

1. 建立一个空接口

   ```java
   public interface BasicInfo {
   }
   ```

2. 在对校验对象的属性校验中，增加groups的声明（上面的第2步）

```java
@Size(max = 33)
@NotNull(message = "name 不能为空",groups=BasicInfo.class)
private String name;
```

3. 在校验时使用@Validated声明是对哪个校验组校验，此时校验对象时只会对groups为BasicInfo修饰的属性校验

```java
@RestController
@RequestMapping("/api")
@Validated // 不要忘记在类中加入这个注解，否则会抛出异常
public class PersonController {

    @PostMapping("/person")
    public ResponseEntity<Person> getPerson(@RequestBody @Validated(BasicInfo.class) Person person) {
        return ResponseEntity.ok().body(person);
    }
}
```

